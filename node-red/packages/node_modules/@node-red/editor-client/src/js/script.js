// Bạn có thể thêm mã JavaScript ở đây để tạo và điều khiển dữ liệu trong bảng
fetch('/api/data')
    .then(response => response.json()) // Chuyển đổi phản hồi sang văn bản
    .then(data => {
        // Hiển thị dữ liệu trả về trong phần tử có id là 'dataDisplay'
        const users = data.adminAuth.users;
        function createUserRow(user, index) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${user.username}</td>
                <td>${user.password}</td>
                <td>${user.permissions}</td>
                <td>
                    <button onclick="openModalEdit()">Sửa</button>
                    <button onclick="openModalDelete()">Xóa</button>
                </td>
            `;
            return row;
        }

        // Get the tbody element where user rows will be appended
        const tbody = document.querySelector('tbody');

        // Loop through users and append rows to tbody
        users.forEach((user, index) => {
            const row = createUserRow(user, index);
            tbody.appendChild(row);
        });
    })
    .catch(error => console.error('Lỗi khi nhận dữ liệu:', error));
//***************************** Turn On Modal Add*******************************************
var modal = document.getElementById("myModal");

// Lấy button mở modal
var btn = document.querySelector(".btn-add");

// Lấy phần tử span đóng modal
var span = document.getElementsByClassName("close")[0];

// Khi người dùng click vào nút, mở modal
function openModal() {
  modal.style.display = "block";
}

// Khi người dùng click vào nút đóng (x), đóng modal
function closeModal() {
  modal.style.display = "none";
}

// Khi người dùng click bất kỳ đâu ngoài modal, đóng modal
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

// *************************************** TURN ON MODAL EDIT**********************************
var modalEdit = document.getElementById("myModalEdit");

// Lấy button mở modal
var btn = document.querySelector(".btn-add");

// Lấy phần tử span đóng modal
var span = document.getElementsByClassName("close")[0];

// Khi người dùng click vào nút, mở modal
function openModalEdit() {
    modalEdit.style.display = "block";
}

// Khi người dùng click vào nút đóng (x), đóng modal
function closeModalEdit() {
    modalEdit.style.display = "none";
}

// Khi người dùng click bất kỳ đâu ngoài modal, đóng modal
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

// ^********************************** TURN ON XÓA TÀI KHOẢN*********************
var modalDelete = document.getElementById("myModalDelete");

// Lấy button mở modal


// Lấy phần tử span đóng modal
var span = document.getElementsByClassName("close")[0];

// Khi người dùng click vào nút, mở modal
function openModalDelete() {
    modalDelete.style.display = "block";
}

// Khi người dùng click vào nút đóng (x), đóng modal
function closeModalDelete() {
    modalDelete.style.display = "none";
}

// Khi người dùng click vào nút xác nhận, xóa tài khoản
function deleteAccount() {
  alert("Tài khoản của bạn đã bị xóa!");
  closeModal(); // Đóng modal sau khi xác nhận
}